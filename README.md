# Axiom Trader 监控工具：需求规格说明

本文档详细描述了Axiom Trader监控工具的功能需求和实施规格。

## 1. 核心功能

创建一个Web应用，通过浏览器插件从 `axiom.trade` 网站实时获取加密货币数据，根据用户配置的策略进行分析，并在满足条件时通过Telegram Bot发送通知。

## 2. 数据获取 (浏览器插件)

- **触发机制:** 当主应用页面打开时，自动打开并注入脚本到 `axiom.trade/discover` 页面。
- **拦截方式:** 通过`Proxy`拦截`JSON.parse`，捕获WebSocket消息。
- **目标数据:** 筛选`room: "surge-updates"` (代币信息) 和 `room: "sol_price"` (SOL价格) 的数据。
- **数据通讯:** 将捕获的数据实时发送到主应用页面。

## 3. 主应用 (Web App)

- **技术栈:** Next.js, TypeScript, Zustand。
- **UI:** 整体为**浅色主题**。使用 **Tailwind CSS** + **Shadcn/ui** 组件库。

## 4. 主页 UI 与功能 (`/`)

### 4.1. 顶部信息栏

- **文案格式:** `总:${x}条 高倍:${y} SOL:${solPrice} 最近更新:${updateTime}`
- **数据源:** 实时显示代币总数、高倍数、SOL价格和最新更新时间。

### 4.2. Token数据表格

- **结构:** 表头固定，内容可滚动。
- **列包含:**
    - **是否买入:** 显示该代币是否已触发策略通知。
        - **否:** 未触发。
        - **是 (市值: ${marketCap}):** 已触发，并显示触发通知时的市值。
    - 其他从`surge-updates`获取的数据字段。
- **高亮:** 满足“高倍筛选”条件的行高亮显示。
- **链接:** `tokenTicker`列是可点击链接，格式为 `https://axiom.trade/t/${ticker}`。
- **格式化:** 所有以SOL计价的字段需乘以实时`solPrice`，并格式化为K/M（千/百万）单位。

### 4.3. 策略管理

- **功能:** 创建、编辑、删除、启用/禁用策略。
- **保存内容:** 筛选条件（`tokenTicker`, 涨幅, 市值等）、策略名称、优先级(1-5)、关联的Bot。
- **交互:**
    - 列表按优先级（数字大的优先）展示。
    - 提供 **`查看`** 按钮，点击后将该策略的筛选条件应用到Token表格。

## 5. 其他页面

- **Bot配置 (`/conf`):** 提供对Telegram Bot（API Key, Channel ID, 名称）的增、删、改、查管理界面。
- **历史记录 (`/history`):** 展示已发送的Telegram通知日志，最新记录在前。

## 6. 核心逻辑

- **通知触发:** 当一个`token`数据满足任意一个**已启用**策略的条件时，触发通知。
- **买入标记:** 触发通知时，将该`token`标记为“已买入”，并记录下当前的市值，用于在表格中展示。
- **发送锁定:** 同一个`token`满足同一个策略，只发送一次通知，防止重复。
- **日志记录:** 成功发送通知后，在`history`中记录日志（发送时间、策略名、市值、Token CA）。
- **持久化:** 所有`tokens`, `strategies`, `bots`, `history`数据均使用`localStorage`持久化。
    - `tokens`上限10000条，`history`上限500条，超出则自动丢弃最旧数据。

## 7. 健壮性

- **自动刷新:** 页面每30分钟自动刷新一次。
- **标签页联动:** 关闭主应用时，自动关闭关联的`axiom.trade`标签页。
- **后台运行:** 在`/conf`和`/history`页面时，主逻辑（数据接收和策略监控）在后台保持运行。
